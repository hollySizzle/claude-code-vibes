# ドキュメント規約

## 関連ドキュメント

- @vibes/rules/coding_standards.md
- @vibes/specs/architecture.md

## 1. 基本方針

ドキュメントは「何を」「なぜ」「どのように」に集中し、プロジェクトの理解と実装を支援することを目的とする。

### 1.1 簡潔性原則

- **最小限記載**: 必要最小限の情報のみ
- **冗長排除**: 前置き・後置き・説明文を排除
- **1 文完結**: 伝わる内容は 1 文で完結
- **詳細分離**: 具体例・詳細は別ドキュメントまたはコメントで管理

### 1.2 vibes/docs ディレクトリ分類

| ディレクトリ | 目的             | 内容                             | 変更制限                 | 対象者             |
| ------------ | ---------------- | -------------------------------- | ------------------------ | ------------------ |
| apis/        | 外部サービス連携 | API 仕様書、連携プロトコル       | 原則変更不可             | システム管理者     |
| logics/      | ビジネスロジック | 業務フロー、計算式、判定条件     | 仕様変更に応じて更新     | 開発者、業務担当者 |
| rules/       | プロジェクト規約 | コーディング規約、命名規則       | チーム合意に基づく変更   | 全開発者           |
| tasks/       | 作業手順書       | 手順書、チェックリスト、ガイド   | 実作業に応じて柔軟に更新 | 実装者、運用担当者 |
| specs/       | 技術仕様         | システム仕様、アーキテクチャ設計 | アーキテクチャ変更時のみ | アーキテクト       |
| temps/       | 一時ドキュメント | 進行中タスク、検討事項、実装メモ | 作業完了後削除           | 実装者             |

## 2. バージョン管理方針

### 2.1 責務分離

- **バージョン管理は Git の責務**、ドキュメント内容とは別の関心事
- ドキュメントは「何を」「なぜ」「どのように」に集中
- バージョン情報とドキュメント内容を分離し、各々の責務を明確化

### 2.2 実装方針

- **記載しないもの**: バージョン番号、変更履歴、作成日時、更新日時
- **Git 管理するもの**: 変更理由、変更経緯、変更内容の詳細
- **例外記載**: API バージョン、スキーマバージョン（システム動作に直接影響）
- **自動挿入**: HTML コメント形式の最終更新日時、INDEX.md の自動生成タイムスタンプ

## 3. ドキュメント更新手順

### 3.1 更新時の基本手順

1. **内容の更新**: 本質的な情報のみを更新
2. **目次の更新**: `ruby scripts/update_toc.rb`を実行
3. **Git コミット**: 変更理由を明確にしたコミットメッセージで管理

### 3.2 新規ドキュメント追加

1. **設定ファイル編集**: `scripts/toc_config.yml`を編集
2. **目次更新実行**: `ruby scripts/update_toc.rb`を実行
3. **関連ドキュメントの更新**: 必要に応じて他のドキュメントのリンクを追加

## 4. 一時ドキュメント記載ルール

### 4.1 基本方針

一時ドキュメント（`doc/temp/`）は、プロジェクト進行中の課題解決や実装計画を管理する。

### 4.2 配置・命名規則

- **配置場所**: `doc/temp/` ディレクトリ内
- **命名規則**: `{目的}_{内容種別}_checklist.md` または `{目的}_{内容種別}.md`

### 4.3 記載形式

#### 4.3.1 チェックリスト方式

タスク分解を行い、チェックリスト方式で記載：

```markdown
## ✅ Phase 1: 基本実装

- [ ] Task 1: 基本機能実装
  - [ ] サブタスク 1-1: モデル作成
  - [ ] サブタスク 1-2: コントローラ実装
- [x] Task 2: 完了済みタスク
```

#### 4.3.2 必須セクション

- **📋 目的**: ドキュメントの目的と背景
- **🎯 課題**: 解決すべき具体的課題
- **📊 進捗**: 現在の状況と成果指標
- **✅ 実行計画**: Phase 別のタスクリスト

#### 4.3.3 推奨セクション

- **🔍 分析結果**: 課題分析の詳細
- **💡 解決案**: 具体的な技術的解決策
- **⚠️ 注意点**: 実装時の留意事項
- **📈 期待効果**: 実装後の改善効果

### 4.4 技術実装詳細

基本的な実装例とファイルパスを記載し、詳細は別ドキュメントで管理：

```ruby
# 実装例
class SomeController < ApplicationController
  def action_name
    # 実装詳細
  end
end
```

**対象ファイル**: `app/controllers/some_controller.rb`

```bash
# 実行コマンド
bin/rails generate migration AddFieldToModel field:type
bin/rails db:migrate
```

### 4.5 進捗管理

#### 4.5.1 進捗表示

- **完了**: `[x]` マーク
- **進行中**: `[ ]` マーク + 📝 進行中表示
- **保留**: `[ ]` マーク + ⏸️ 保留理由

#### 4.5.2 成果指標

具体的な数値目標を記載：

```markdown
- **テスト成功率**: 61% → 100%
- **エラー解決**: 5 件 → 0 件
```
